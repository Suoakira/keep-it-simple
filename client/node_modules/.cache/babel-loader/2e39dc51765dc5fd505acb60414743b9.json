{"ast":null,"code":"import _toConsumableArray from \"/Users/home/Development/end_of_module_projects/module5/final_project/keep-it-simple/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"/Users/home/Development/end_of_module_projects/module5/final_project/keep-it-simple/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Users/home/Development/end_of_module_projects/module5/final_project/keep-it-simple/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/home/Development/end_of_module_projects/module5/final_project/keep-it-simple/client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/home/Development/end_of_module_projects/module5/final_project/keep-it-simple/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/home/Development/end_of_module_projects/module5/final_project/keep-it-simple/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/home/Development/end_of_module_projects/module5/final_project/keep-it-simple/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/home/Development/end_of_module_projects/module5/final_project/keep-it-simple/client/src/components/SavingsForm.js\";\nimport React, { Component } from 'react';\nimport _ from 'lodash';\nimport ResultRenderer from \"./ResultRenderer\";\nimport { Grid, Header, Segment, Select, Form, Message, Search, Icon } from 'semantic-ui-react';\nimport API from \"../API\";\nimport { Redirect } from \"react-router-dom\";\nimport { DatesRangeInput } from 'semantic-ui-calendar-react';\n\nvar SavingsForm =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(SavingsForm, _Component);\n\n  function SavingsForm(props) {\n    var _this;\n\n    _classCallCheck(this, SavingsForm);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(SavingsForm).call(this, props));\n\n    _this.splitDate = function (date) {\n      return date.split(\" - \");\n    };\n\n    _this.handleChange = function (e, _ref) {\n      var name = _ref.name,\n          value = _ref.value;\n      return _this.setState(_defineProperty({}, name, value));\n    };\n\n    _this.handleSubmit = function (event) {\n      event.preventDefault();\n      var SavingTargetId = undefined;\n      var _this$state = _this.state,\n          name = _this$state.name,\n          category = _this$state.category,\n          target_image = _this$state.target_image,\n          plan = _this$state.plan,\n          datesRange = _this$state.datesRange,\n          user_id = _this$state.user_id,\n          amount = _this$state.amount;\n      var SavingTarget = {\n        name: name,\n        start_date: _this.splitDate(datesRange)[0],\n        end_date: _this.splitDate(datesRange)[1],\n        category: category,\n        target_image: target_image,\n        plan: plan\n      };\n      API.postSavingsTarget(SavingTarget).then(function (resp) {\n        if (resp.error) {\n          console.log(resp.error);\n\n          _this.setState({\n            errorST: resp.error\n          });\n\n          _this.setState({\n            error: resp.error\n          });\n        } else {\n          SavingTargetId = resp.id;\n          console.log(resp);\n        }\n      }).then(function () {\n        return API.postUserSavingsTarget({\n          user_id: user_id,\n          saving_target_id: SavingTargetId,\n          amount: amount\n        });\n      }).then(function (resp) {\n        if (resp.error) {\n          console.log(resp.error);\n\n          _this.setState({\n            errorUST: resp.error\n          });\n        } else {\n          _this.setState({\n            submit: true\n          });\n\n          console.log(resp);\n        }\n      });\n    };\n\n    _this.mapJoinPostRequests = function (savingTargetId) {\n      var loggedInUser = {\n        user_id: _this.state.user_id,\n        saving_target_id: undefined,\n        amount: _this.state.amount\n      };\n\n      var savingTargets = _toConsumableArray(_this.state.mapToApi); // cant just unshift here as user hasnt submitted their amount they should save yet\n      // savingTargets.unshift(loggedInUser)\n\n\n      console.log(savingTargets); // return savingTargets.map(savingTarget => API.postUserSavingsTarget(savingTarget))\n    };\n\n    _this.addUserToPlan = function () {\n      if (_this.state.results[0] && _this.state.target) {\n        console.log(\"added user to group\");\n        var copyUser = JSON.parse(JSON.stringify(_toConsumableArray(_this.state.results)[0]));\n        console.log(copyUser);\n        var amount = _this.state.target;\n        console.log(amount);\n        console.log(copyUser.id);\n\n        _this.setState({\n          groupUsers: _toConsumableArray(_this.state.groupUsers).concat([{\n            user: copyUser,\n            user_id: copyUser.id,\n            amount: amount\n          }]),\n          mapToApi: _toConsumableArray(_this.state.mapToApi).concat([{\n            user_id: copyUser.id,\n            saving_target_id: undefined,\n            amount: amount\n          }])\n        });\n      } else {\n        // replace this alert box\n        alert(\"you didnt enter a user or amount (placeholder alert)\");\n      }\n    };\n\n    _this.mapGroupUsers = function () {\n      var copyGroupUsers = _toConsumableArray(_this.state.groupUsers);\n\n      return copyGroupUsers.map(function (groupMember) {\n        return React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 133\n          },\n          __self: this\n        }, groupMember.user.username, \" \", groupMember.amount, \"  \");\n      });\n    };\n\n    _this.resetComponent = function () {\n      return _this.setState({\n        isLoading: false,\n        results: [],\n        value: ''\n      });\n    };\n\n    _this.handleResultSelect = function (e, _ref2) {\n      var result = _ref2.result;\n      return _this.setState({\n        value: result.username\n      });\n    };\n\n    _this.handleSearchChange = function (e, _ref3) {\n      var value = _ref3.value;\n\n      _this.setState({\n        isLoading: true,\n        value: value\n      });\n\n      setTimeout(function () {\n        if (_this.state.value.length < 1) return _this.resetComponent();\n        var re = new RegExp(_.escapeRegExp(_this.state.value), 'i');\n\n        var isMatch = function isMatch(result) {\n          return re.test(result.username);\n        };\n\n        _this.setState({\n          isLoading: false,\n          results: _.filter(_this.state.allUsers, isMatch)\n        });\n      }, 300);\n    };\n\n    _this.state = {\n      name: undefined,\n      start_date: undefined,\n      end_date: undefined,\n      category: undefined,\n      target_image: undefined,\n      plan: undefined,\n      user_id: undefined,\n      datesRange: '',\n      amount: undefined,\n      propSavingTargets: undefined,\n      errorST: \"\",\n      errorUST: \"\",\n      submit: false,\n      arrayOfUTS: [],\n      allUsers: undefined,\n      results: undefined,\n      groupUsers: [],\n      mapToApi: []\n    };\n    return _this;\n  }\n\n  _createClass(SavingsForm, [{\n    key: \"componentDidMount\",\n    // ----------------------------------- end adding a user to plan ------------------------------------\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      fetch(\"http://localhost:3000/api/v1/users\").then(function (resp) {\n        return resp.json();\n      }).then(function (data) {\n        return _this2.setState({\n          storedUserDetails: _this2.props.storedUserDetails,\n          user_id: _this2.props.storedUserDetails.id,\n          allUsers: data\n        });\n      });\n    } // --------------------------Search Feature Start ------------------------------------------ //\n\n  }, {\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      this.resetComponent();\n    }\n  }, {\n    key: \"render\",\n    // --------------------------Search Feature End ------------------------------------------ //\n    value: function render() {\n      var _this3 = this;\n\n      var _this$state2 = this.state,\n          name = _this$state2.name,\n          category = _this$state2.category,\n          target_image = _this$state2.target_image,\n          amount = _this$state2.amount,\n          plan = _this$state2.plan,\n          isLoading = _this$state2.isLoading,\n          value = _this$state2.value,\n          allUsers = _this$state2.allUsers,\n          results = _this$state2.results;\n      var planOptions = [{\n        key: 'p',\n        text: 'Personal',\n        value: 'Personal'\n      }, {\n        key: 'g',\n        text: 'Group',\n        value: 'Group'\n      }];\n      var categoryOptions = [{\n        key: 'd',\n        text: 'Debt',\n        value: 'Debt'\n      }, {\n        key: 'v',\n        text: 'Vacation',\n        value: 'Vacation'\n      }, {\n        key: 'p',\n        text: 'Present',\n        value: 'Present'\n      }, {\n        key: 'h',\n        text: 'Housing',\n        value: 'Housing'\n      }, {\n        key: 's',\n        text: 'Savings',\n        value: 'Savings'\n      }, {\n        key: 'f',\n        text: 'Family',\n        value: 'Family'\n      }, {\n        key: 'c',\n        text: 'Car',\n        value: 'Car'\n      }, {\n        key: 'a',\n        text: 'Charity',\n        value: 'Charity'\n      }, {\n        key: 'o',\n        text: 'Other',\n        value: 'Other'\n      }];\n      this.mapJoinPostRequests(2);\n      return React.createElement(\"div\", {\n        className: \"wrapper\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196\n        },\n        __self: this\n      }, !this.state.submit ? React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198\n        },\n        __self: this\n      }, React.createElement(Segment, {\n        placeholder: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }, React.createElement(Grid, {\n        columns: 2,\n        stretched: true,\n        verticalAlign: \"middle\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      }, React.createElement(Grid.Row, {\n        verticalAlign: \"middle\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      }, React.createElement(Grid.Column, {\n        width: 8,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        },\n        __self: this\n      }, React.createElement(Header, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203\n        },\n        __self: this\n      }, \"Create Savings Plan\"), React.createElement(Form, {\n        error: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204\n        },\n        __self: this\n      }, React.createElement(Form.Group, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205\n        },\n        __self: this\n      }, React.createElement(Form.Input, {\n        label: \"Plan Name\",\n        placeholder: \"Name\",\n        name: \"name\",\n        value: name,\n        onChange: this.handleChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206\n        },\n        __self: this\n      })), this.state.errorST && this.state.errorUST && !this.state.name && React.createElement(\"div\", {\n        className: \"make-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 211\n        },\n        __self: this\n      }, \"Please enter a valid Plan Name.\")), React.createElement(Form.Group, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214\n        },\n        __self: this\n      }, React.createElement(Form.Field, {\n        control: Select,\n        options: planOptions,\n        label: {\n          children: 'Plan type?',\n          htmlFor: 'planOptions'\n        },\n        placeholder: \"Plan\",\n        search: true,\n        name: \"plan\",\n        value: plan,\n        onChange: this.handleChange,\n        searchInput: {\n          id: 'planOptions'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215\n        },\n        __self: this\n      })), this.state.plan === \"Group\" &&\n      /* this should be in a modal popup */\n      React.createElement(Form.Group, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 230\n        },\n        __self: this\n      }, React.createElement(Form.Field, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 231\n        },\n        __self: this\n      }, React.createElement(\"b\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 232\n        },\n        __self: this\n      }, \"Add a User and amount they should save\"), this.state.groupUsers[0] && React.createElement(Segment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234\n        },\n        __self: this\n      }, this.mapGroupUsers()), React.createElement(Search, Object.assign({\n        loading: isLoading,\n        placeholder: \"Enter Username...\",\n        onResultSelect: this.handleResultSelect,\n        onSearchChange: _.debounce(this.handleSearchChange, 500, {\n          leading: true\n        }),\n        results: results,\n        value: value\n      }, this.props, {\n        resultRenderer: ResultRenderer,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 238\n        },\n        __self: this\n      })), React.createElement(Icon, {\n        name: \"pound sign\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 249\n        },\n        __self: this\n      }), \"Amount\", React.createElement(Form.Input, {\n        type: \"number\",\n        name: \"target\",\n        value: name,\n        onChange: this.handleChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 249\n        },\n        __self: this\n      }), React.createElement(\"button\", {\n        onClick: function onClick() {\n          return _this3.addUserToPlan();\n        },\n        class: \"mini primary ui button\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250\n        },\n        __self: this\n      }, \"Add User\"))), this.state.errorST && this.state.errorUST && !this.state.name ? React.createElement(\"div\", {\n        className: \"make-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 258\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 259\n        },\n        __self: this\n      }, \"Please enter a valid Plan type.\")) : null, React.createElement(Form.Group, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 264\n        },\n        __self: this\n      }, React.createElement(Form.Field, {\n        control: Select,\n        options: categoryOptions,\n        label: {\n          children: 'Category?',\n          htmlFor: 'categoryOptions'\n        },\n        placeholder: \"category\",\n        search: true,\n        name: \"category\",\n        value: category,\n        onChange: this.handleChange,\n        searchInput: {\n          id: 'categoryOptions'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 265\n        },\n        __self: this\n      })), this.state.errorST && this.state.errorUST && !this.state.category ? React.createElement(\"div\", {\n        className: \"make-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 278\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 279\n        },\n        __self: this\n      }, \"Please enter a valid Category.\")) : null, React.createElement(Form.Group, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 284\n        },\n        __self: this\n      }, React.createElement(Form.Input, {\n        label: \"Image Url\",\n        placeholder: \"Image\",\n        name: \"target_image\",\n        value: target_image,\n        onChange: this.handleChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 285\n        },\n        __self: this\n      })), this.state.errorST && this.state.errorUST && !this.state.target_image ? React.createElement(\"div\", {\n        className: \"make-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 288\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 289\n        },\n        __self: this\n      }, \"Please enter a valid image url.\")) : null, React.createElement(Form.Group, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 295\n        },\n        __self: this\n      }, React.createElement(Form.Input, {\n        type: \"number\",\n        label: \"Amount to save (\\xA3)\",\n        placeholder: \"Amount\",\n        name: \"amount\",\n        value: amount,\n        onChange: this.handleChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 296\n        },\n        __self: this\n      })), this.state.errorST && this.state.errorUST && !this.state.target_image ? React.createElement(\"div\", {\n        className: \"make-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 300\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 301\n        },\n        __self: this\n      }, \"Please enter an amount to save.\")) : null, React.createElement(Form.Group, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 307\n        },\n        __self: this\n      }, React.createElement(DatesRangeInput, {\n        label: \"Plan Start/End dates\",\n        name: \"datesRange\",\n        placeholder: \"From - To\",\n        value: this.state.datesRange,\n        iconPosition: \"left\",\n        minDate: new Date(),\n        onChange: this.handleChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 308\n        },\n        __self: this\n      })), this.state.errorST && this.state.errorUST && !this.state.start_date && !this.state.end_date ? React.createElement(\"div\", {\n        className: \"make-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 320\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 321\n        },\n        __self: this\n      }, \"Please enter a valid start, and end date\")) : null, React.createElement(\"div\", {\n        class: \"ui medium primary button\",\n        onClick: function onClick(event) {\n          return _this3.handleSubmit(event);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 326\n        },\n        __self: this\n      }, \"Create Plan \", React.createElement(\"i\", {\n        class: \"right arrow icon\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 326\n        },\n        __self: this\n      })), this.state.error ? React.createElement(Message, {\n        error: true,\n        header: \"Action Forbidden\",\n        content: this.state.error,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 328\n        },\n        __self: this\n      }) : null)), React.createElement(Grid.Column, {\n        width: 8,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 338\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 339\n        },\n        __self: this\n      }, !this.state.target_image ? React.createElement(\"img\", {\n        src: \"https://www.mstreetbank.com/wp-content/uploads/2018/04/piggy-bank-update.jpg\",\n        id: \"savings-image1\",\n        alt: \"plant growing out of hand\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 341\n        },\n        __self: this\n      }) : React.createElement(\"div\", {\n        className: \"width-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 343\n        },\n        __self: this\n      }, React.createElement(Segment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 344\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        src: this.state.target_image,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 345\n        },\n        __self: this\n      })))))))), React.createElement(\"div\", {\n        className: \"historypad\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 357\n        },\n        __self: this\n      })) : React.createElement(Redirect, {\n        to: \"/home/exisitingplans\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 360\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return SavingsForm;\n}(Component);\n\nexport default SavingsForm;","map":{"version":3,"sources":["/Users/home/Development/end_of_module_projects/module5/final_project/keep-it-simple/client/src/components/SavingsForm.js"],"names":["React","Component","_","ResultRenderer","Grid","Header","Segment","Select","Form","Message","Search","Icon","API","Redirect","DatesRangeInput","SavingsForm","props","splitDate","date","split","handleChange","e","name","value","setState","handleSubmit","event","preventDefault","SavingTargetId","undefined","state","category","target_image","plan","datesRange","user_id","amount","SavingTarget","start_date","end_date","postSavingsTarget","then","resp","error","console","log","errorST","id","postUserSavingsTarget","saving_target_id","errorUST","submit","mapJoinPostRequests","savingTargetId","loggedInUser","savingTargets","mapToApi","addUserToPlan","results","target","copyUser","JSON","parse","stringify","groupUsers","user","alert","mapGroupUsers","copyGroupUsers","map","groupMember","username","resetComponent","isLoading","handleResultSelect","result","handleSearchChange","setTimeout","length","re","RegExp","escapeRegExp","isMatch","test","filter","allUsers","propSavingTargets","arrayOfUTS","fetch","json","data","storedUserDetails","planOptions","key","text","categoryOptions","children","htmlFor","debounce","leading","Date"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport _ from 'lodash'\nimport ResultRenderer from \"./ResultRenderer\"\nimport {   Grid, Header, Segment, Select, Form, Message, Search, Icon } from 'semantic-ui-react'\n\nimport API from \"../API\"\nimport { Redirect } from \"react-router-dom\"\n\n\nimport {\n    DatesRangeInput\n} from 'semantic-ui-calendar-react';\n\nclass SavingsForm extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n                name: undefined,\n                start_date: undefined,\n                end_date: undefined,\n                category: undefined,\n                target_image: undefined,\n                plan: undefined,\n                user_id: undefined,\n                datesRange: '',\n                amount: undefined,\n                propSavingTargets: undefined,\n                errorST: \"\",\n                errorUST: \"\",\n                submit: false, \n                arrayOfUTS: [],\n\n                allUsers: undefined,\n                results: undefined,\n                groupUsers: [],\n                mapToApi: []\n\n            }\n        }\n\n    splitDate = (date) => {\n        return date.split(\" - \")\n    }\n\n    handleChange = (e, { name, value }) => this.setState({ [name]: value })\n\n    handleSubmit = (event) => {\n        event.preventDefault()\n        let SavingTargetId = undefined\n        const { name, category, target_image, plan, datesRange, user_id, amount } = this.state\n        const SavingTarget = {\n            name: name,\n            start_date: this.splitDate(datesRange)[0],\n            end_date: this.splitDate(datesRange)[1],\n            category: category,\n            target_image: target_image,\n            plan: plan\n        }\n        API.postSavingsTarget(SavingTarget)\n            .then(resp => {\n                if (resp.error){\n                    console.log(resp.error)\n                    this.setState({ errorST: resp.error })\n                    this.setState({error: resp.error})\n                } else {\n                SavingTargetId = resp.id\n                console.log(resp)\n                }\n            })\n            .then(() => API.postUserSavingsTarget(\n                {\n                user_id: user_id,\n                saving_target_id: SavingTargetId,\n                amount: amount\n                }\n            )).then(resp => {\n                if (resp.error) {\n                    console.log(resp.error)\n                    this.setState({ errorUST: resp.error })\n                } else {\n                    this.setState({submit: true})\n                    console.log(resp)\n                }\n            })     \n    }\n\n    mapJoinPostRequests = (savingTargetId) => {\n                let loggedInUser = {\n                user_id: this.state.user_id,\n                saving_target_id: undefined,\n                amount: this.state.amount\n                }\n        const savingTargets = [...this.state.mapToApi]\n        // cant just unshift here as user hasnt submitted their amount they should save yet\n        // savingTargets.unshift(loggedInUser)\n        \n        console.log(savingTargets)\n\n    \n        // return savingTargets.map(savingTarget => API.postUserSavingsTarget(savingTarget))\n    }\n\n// ------------------------------------ wtart adding a user to a plan -------------------------------------\n    addUserToPlan = () => {\n        if (this.state.results[0] && this.state.target) {\n        console.log(\"added user to group\")\n        const copyUser = JSON.parse(JSON.stringify([...this.state.results][0]))\n        console.log(copyUser)\n        const amount = this.state.target\n        console.log(amount)\n        console.log(copyUser.id)\n        this.setState({ \n            groupUsers: [...this.state.groupUsers,\n            {user: copyUser,\n            user_id: copyUser.id ,\n            amount: amount}],\n            mapToApi: [...this.state.mapToApi,\n        {\n            user_id: copyUser.id,\n            saving_target_id: undefined,\n            amount: amount\n        }\n            ]\n        })\n        } else {\n            // replace this alert box\n            alert(\"you didnt enter a user or amount (placeholder alert)\")\n        }\n    }\n\n    mapGroupUsers = () => {\n        const copyGroupUsers = [...this.state.groupUsers]\n        return copyGroupUsers.map(groupMember => <p>{groupMember.user.username} {groupMember.amount}  </p>)\n\n    }\n\n    // ----------------------------------- end adding a user to plan ------------------------------------\n\n    componentDidMount() {\n        fetch(\"http://localhost:3000/api/v1/users\")\n        .then(resp => resp.json())\n            .then(data => this.setState({\n                storedUserDetails: this.props.storedUserDetails,\n                user_id: this.props.storedUserDetails.id,\n                allUsers: data\n            }) \n        )\n    }\n\n    // --------------------------Search Feature Start ------------------------------------------ //\n    componentWillMount() {\n        this.resetComponent()\n    }\n\n    resetComponent = () => this.setState({ isLoading: false, results: [], value: '' })\n\n    handleResultSelect = (e, { result }) => this.setState({ value: result.username })\n\n    handleSearchChange = (e, { value }) => {\n        this.setState({ isLoading: true, value })\n\n        setTimeout(() => {\n            if (this.state.value.length < 1) return this.resetComponent()\n\n            const re = new RegExp(_.escapeRegExp(this.state.value), 'i')\n            const isMatch = result => re.test(result.username)\n\n            this.setState({\n                isLoading: false,\n                results: _.filter(this.state.allUsers, isMatch)\n            })\n        }, 300)\n    }\n    // --------------------------Search Feature End ------------------------------------------ //\n\n    render() { \n        const { name, category, target_image, amount, plan, isLoading, value, allUsers, results } = this.state\n        const planOptions = [\n            { key: 'p', text: 'Personal', value: 'Personal' },\n            { key: 'g', text: 'Group', value: 'Group' },\n        ]\n        const categoryOptions = [\n            { key: 'd', text: 'Debt', value: 'Debt' },\n            { key: 'v', text: 'Vacation', value: 'Vacation' },\n            { key: 'p', text: 'Present', value: 'Present' },\n            { key: 'h', text: 'Housing', value: 'Housing' },\n            { key: 's', text: 'Savings', value: 'Savings' },\n            { key: 'f', text: 'Family', value: 'Family' },\n            { key: 'c', text: 'Car', value: 'Car' },\n            { key: 'a', text: 'Charity', value: 'Charity' },\n            { key: 'o', text: 'Other', value: 'Other' },\n        ]\n        this.mapJoinPostRequests(2)\n\n        return (\n            <div className=\"wrapper\">\n                {!this.state.submit ?\n                    <React.Fragment>\n                <Segment placeholder>\n                            <Grid columns={2} stretched verticalAlign=\"middle\">\n                            <Grid.Row verticalAlign='middle'>\n                                <Grid.Column width={8}>\n                                <Header>Create Savings Plan</Header>\n                            <Form error>\n                                <Form.Group>\n                                    <Form.Input label=\"Plan Name\" placeholder='Name' name='name' value={name} onChange={this.handleChange} />\n                                </Form.Group>\n\n                                    {(this.state.errorST && this.state.errorUST && !this.state.name) &&\n                                        <div className=\"make-center\">\n                                            <p>Please enter a valid Plan Name.</p>\n                                        </div>\n                                    }\n                                <Form.Group>  \n                                    <Form.Field\n                                        control={Select}\n                                        options={planOptions}\n                                        label={{ children: 'Plan type?', htmlFor: 'planOptions' }}\n                                        placeholder='Plan'\n                                        search\n                                        name=\"plan\"\n                                        value={plan}\n                                        onChange={this.handleChange}\n                                        searchInput={{ id: 'planOptions' }}\n                                    />\n                                        \n                                </Form.Group>\n                                    {(this.state.plan === \"Group\") &&\n                                    /* this should be in a modal popup */\n                                    <Form.Group>  \n                                        <Form.Field>\n                                            <b>Add a User and amount they should save</b>\n                                                {this.state.groupUsers[0] &&\n                                                    <Segment>\n                                                        {this.mapGroupUsers()}\n                                                    </Segment>\n                                                }\n                                        <Search\n                                                loading={isLoading}\n                                                placeholder=\"Enter Username...\"\n                                                onResultSelect={this.handleResultSelect}\n                                                onSearchChange={_.debounce(this.handleSearchChange, 500, { leading: true })}\n                                                results={results}\n                                                value={value}\n                                                {...this.props}\n                                                resultRenderer={ResultRenderer}\n                                            />\n                                                {/* not wired up yet */}\n                                                    <Icon name='pound sign' />Amount<Form.Input type=\"number\" name='target' value={name} onChange={this.handleChange}></Form.Input>\n                                                <button onClick={() => this.addUserToPlan()}class=\"mini primary ui button\">\n                                                    Add User\n                                                </button>\n                                            </Form.Field>\n                                        </Form.Group>  \n                                    }\n        \n                                    {(this.state.errorST && this.state.errorUST && !this.state.name) ?\n                                        <div className=\"make-center\">\n                                            <p>Please enter a valid Plan type.</p>\n                                        </div>\n                                        :\n                                        null\n                                    }\n                                <Form.Group>\n                                    <Form.Field\n                                        control={Select}\n                                        options={categoryOptions}\n                                        label={{ children: 'Category?', htmlFor: 'categoryOptions' }}\n                                        placeholder='category'\n                                        search\n                                        name=\"category\"\n                                        value={category}\n                                        onChange={this.handleChange}\n                                        searchInput={{ id: 'categoryOptions' }}\n                                    />\n                                </Form.Group>\n                                {(this.state.errorST && this.state.errorUST && !this.state.category) ?\n                                    <div className=\"make-center\">\n                                        <p>Please enter a valid Category.</p>\n                                    </div>\n                                    :\n                                    null\n                                }\n                                <Form.Group>\n                                <Form.Input label=\"Image Url\" placeholder='Image' name='target_image' value={target_image} onChange={this.handleChange}  />\n                                </Form.Group>\n                                    {(this.state.errorST && this.state.errorUST && !this.state.target_image) ?\n                                        <div className=\"make-center\">\n                                            <p>Please enter a valid image url.</p>\n                                        </div>\n                                        :\n                                        null\n                                    }\n\n                                <Form.Group>\n                                <Form.Input type=\"number\" label=\"Amount to save ()\" placeholder='Amount' name='amount' value={amount} onChange={this.handleChange} />\n                                </Form.Group>\n\n                                    {(this.state.errorST && this.state.errorUST && !this.state.target_image) ?\n                                        <div className=\"make-center\">\n                                            <p>Please enter an amount to save.</p>\n                                        </div>\n                                        :\n                                        null\n                                    }\n                                \n                                <Form.Group>\n                                    <DatesRangeInput\n                                        label=\"Plan Start/End dates\"\n                                        name=\"datesRange\"\n                                        placeholder=\"From - To\"\n                                        value={this.state.datesRange}\n                                        iconPosition=\"left\"\n                                        minDate= {new Date()}\n                                        onChange={this.handleChange} />\n                                    \n                                </Form.Group>\n\n                                    {(this.state.errorST && this.state.errorUST && !this.state.start_date && !this.state.end_date ) ?\n                                        <div className=\"make-center\">\n                                            <p>Please enter a valid start, and end date</p>\n                                        </div>\n                                        :\n                                        null\n                                    }\n                                    <div class=\"ui medium primary button\" onClick={(event) => this.handleSubmit(event)}>Create Plan <i class=\"right arrow icon\"></i></div>\n                                    {this.state.error ?\n                                        <Message\n                                            error\n                                            header='Action Forbidden'\n                                            content={this.state.error}\n                                        />\n                                        :\n                                        null\n                                    }\n                            </Form>\n                            </Grid.Column>\n                            <Grid.Column width={8}>\n                                    <div>\n                                    {!this.state.target_image?\n                                                <img src=\"https://www.mstreetbank.com/wp-content/uploads/2018/04/piggy-bank-update.jpg\" id=\"savings-image1\" alt=\"plant growing out of hand\" />\n                                    :\n                                    <div className=\"width-container\">\n                                        <Segment>\n                                                <img src={this.state.target_image}/>\n                                        </Segment>\n                                    </div>\n                                    }\n\n                                    </div>\n             \n                            </Grid.Column>\n                        </Grid.Row>\n                    </Grid>\n                \n            </Segment>\n                <div className=\"historypad\"></div>\n        </React.Fragment>      \n            :\n                    <Redirect to=\"/home/exisitingplans\" />\n                }\n            </div>\n            \n\n\n \n\n\n         )\n    }\n}\n \nexport default SavingsForm"]},"metadata":{},"sourceType":"module"}